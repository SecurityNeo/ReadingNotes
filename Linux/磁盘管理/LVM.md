# LVM #

## 基本术语 ##

![](img/LVM.png)

**物理卷（Physical volume） (PV)**

物理卷在逻辑卷管理中处于最底层，它可以是实际物理硬盘上的分区，也可以是整个物理硬盘，创建PV时要求系统分区的system ID为8e。

**卷组（Volumne Group）（VG）**

卷组建立在物理卷上，一卷组中至少要包括一个物理卷，卷组建立后可动态的添加卷到卷组中，一个逻辑卷管理系统工程中可有多个卷组。

**逻辑卷（Logical Volume）（LV）**

逻辑卷建立在卷组之上，可以使用卷组中未分配的空间建立逻辑卷，逻辑卷可以动态地扩展和缩小空间。系统中的多个逻辑卷要以属于同一个卷组，也可以属于不同的多个卷组。其相当于非LVM系统中的磁盘分区。

**条块化的逻辑卷（Striped Logical Volumes）**

向此逻辑卷中写入数据时,文件系统能将数据放置到多个物理卷中，对于大量连接读写操作,能改善数据I/O效率。

**线性逻辑卷（Linear Volumes）**

一个线性逻辑卷聚合多个物理卷成为一个逻辑卷

**物理区域（Physical Extent）（PE）**

物理区域是物理卷中可用于分配的最小存储单元，在创建卷组时可指定物理区域的大小，默认为4M，后期不能更改，同一卷组所有物理卷的物理区域大小需一致。实际的数据就是存储在此。

**逻辑区域（Logical Extent）（LE）**

LE为逻辑存储单元，PE为物理存储单元，它的大小和PE的大小一样，并且与之一一对应。

由于受内核限制的原因，一个逻辑卷（Logic Volume）最多只能包含65536个PE（Physical Extent），所以一个PE的大小就决定了逻辑卷的最大容量，4MB(默认) 的PE决定了单个逻辑卷最大容量为256GB，若希望使用大于256G的逻辑卷，则创建卷组时需要指定更大的PE

**卷组描述符区域（VGDA）**

逻辑卷以及卷组相关的元数据保存在位于物理卷起始处的VGDA(卷组描述符区域)中。VGDA内存储有以下信息： PV描述符、VG描述符、LV描述符、和一些PE描述符。在系统启动LVM时激活VG，并将VGDA加载至内存，以此来识别LV的实际物理存储位置。当系统进行I/O操作时，就会根据VGDA建立的映射机制来访问实际的物理位置。

**写入模式**

LVM有两种写入模式：

- 线性模式 (linear)：先将一个PV中的PE写完之后再写入另一个PV，也是LVM的默认模式。 
- 交错模式 (triped)：与Raid0类似，将一份数据拆分成多份，分别写入该LV对应的每个PV中，读写性能较好
